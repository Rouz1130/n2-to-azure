/*! ExxonMobil 2015-12-29 09:12:04 */
angular.module("product-selector",["xom.shared"]),angular.module("product-selector").controller("SelectorCtrl",["$scope","dataSvc",function(a,b){"use strict";function c(b){var c,d=b.length,j=d>h?parseInt(d/i):d;b.sort(g),c=e(b),a.results.groups=d==j?[{sections:c}]:f(c,j)}function d(){for(var b=0;b<a.alphabet.length;b++){var c=a.alphabet[b];a.sectionLetters[c]=a.results.groups.filter(function(a){return a.sections.filter(function(a){return a.letter==c}).length>0}).length>0}}function e(a){if(!a||!a.length)return[];for(var b,c,d,e=[],f=0;f<a.length;f++)c=a[f].text[0],d!=c&&(b={letter:c.toUpperCase(),links:[]},e.push(b),d=c),b.links.push(a[f]);return e}function f(a,b){for(var c,d=[],e=0,f=0;f<a.length;f++)(0===d.length||e>=b)&&(c={sections:[]},d.push(c),e=0),c.sections.push(a[f]),e+=a[f].links.length;return d}function g(a,b){return a.text<b.text?-1:a.text>b.text?1:0}var h=50,i=3;a.alphabet="#ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),a.sectionLetters={},a.results={groups:[]},a.filter={search:"",options:[]},a.applyFilter=function(){a.waiting=!0,b.search(a.filter).then(function(a){c(a),d()})["finally"](function(){a.waiting=!1})},a.applyFilter()}]),angular.module("product-selector").controller("WizardCtrl",["$scope","dataSvc","eventBusSvc","INITIAL_URL",function(a,b,c,d){"use strict";function e(){l(!0),b.recommend(d).then(k)["finally"](l)}function f(a,b){angular.forEach(a.options,function(a){a.isSelected=!1}),b.isSelected=!0,a.title=b.name}function g(c,d){a.hasRecommendation=!1,l(!0),b.recommend(d.url).then(h)["finally"](l)}function h(b){k(b),a.listOffset=0}function i(b){var c=a.lists.indexOf(b);j(c+1)}function j(b){var c=a.lists.length;b>=c||a.lists.splice(b,c-b)}function k(b){a.lists.push(b)}function l(a){c.publish("xom.loading",!!a)}a.lists=[],a.listOffset=0,a.hasRecommendation=!1,a.selectOption=function(b,c){f(b,c),i(b),a.hasRecommendation=c.showrecommendation,c.showrecommendation?a.recommendationUrl=c.url:g(b,c)},a.setOffset=function(b){a.listOffset+=b,1>b&&(a.hasRecommendation=!1)},e()}]),function(a){"use strict";angular.module("product-selector").directive("wizardLists",["$timeout",function(b){return{restrict:"C",link:function(c,d){function e(){return parseInt(i.children(":visible").last().text())}function f(){var b=h.find(".list"),d=h.find(".view-recommendations"),f=d.hasClass("view-recommendations-active"),i=e(),j=100/i,k=b.length+(f?1:0),l=Math.min(k,i),m=k-l,n=Math.min(0,-((m+c.listOffset)*j)),o=!1,p=!1,q=0;0===m&&(c.listOffset=n=0),o=0>n,b.each(function(){var b=a(this);b.css({left:n+"%",width:j+"%"}),p=n>=100,n+=j,q=Math.max(q,b.outerHeight(!0))});var r=Math.max(n,100-j);d.css("left",r+"%"),h.height(q),g.toggleClass("lists-to-left",o),g.toggleClass("lists-to-right",p)}var g=a(d),h=g.find(".lists-slider"),i=g.find(".list-count");c.$watch("[listOffset, hasRecommendation]",function(a){b(f)},!0),c.$watchCollection("lists",function(a){a&&b(f)}),a(window).resize(f)}}}])}(window.jQuery),angular.module("product-selector").factory("dataSvc",["$http","$q","API_ROOT",function(a,b,c){"use strict";function d(a){var c=b.defer();return setTimeout(function(){var a=f();c.resolve(a)},500),c.promise}function e(d){var e=b.defer();return a({method:"GET",url:c+d}).then(function(a){var b=h(a.data.conditionlist);e.resolve(b)})["catch"](function(){e.reject("Failed to load recommendations.")}),e.promise}function f(){for(var a=[],b=Math.floor(500*Math.random())+1,c=0;b>c;c++)a.push({url:"#",text:g()});return a}function g(){for(var a=[],b=Math.floor(6*Math.random())+1,c=i.length,d=0,e=0;b>e;e++)d=Math.floor(Math.random()*c),a.push(i[d]);return a.join(" ")}function h(a){return{title:a.title,options:a.values}}var i="meowing non stop make meme cute face or give attitude and jump around on couch meow constantly until given food for cat snacks loves cheeseburgers who the baby".split(" ");return{search:d,recommend:e}}]),function(a){a("script[data-app]").each(function(){var b=a(this),c=b.data("app"),d=a.parseJSON(b.html());for(var e in d)angular.module(c).constant(e,d[e])})}(window.jQuery),angular.module("xom.shared",[]),function(a){"use strict";angular.module("xom.shared").factory("eventBusSvc",function(){return{publish:a.publish,subscribe:a.subscribe}})}(window.jQuery);